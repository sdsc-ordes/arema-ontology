services:
  arema-ontology:
    build: .
    container_name: arema-ontology-service
    ports:
      - "8000:8000"
    environment:
      - FUSEKI_URL=http://fuseki:3030/arema/data
      - FUSEKI_UPDATE_URL=http://fuseki:3030/arema/data
      - FUSEKI_USERNAME=${FUSEKI_USERNAME}
      - FUSEKI_PASSWORD=${FUSEKI_PASSWORD}
      - SERVICE_ACCOUNT_KEY=/app/service_account.json
      - GOOGLE_SHEET_ID=${GOOGLE_SHEET_ID:-1RL6Y120_H9-yD8x52eZO44S2iLQpLoZHitcExHsPfPs}
      - GOOGLE_SHEET_OBJECTS_GID=${GOOGLE_SHEET_OBJECTS_GID:-1120751986}
      - GOOGLE_SHEET_PROPERTIES_GID=${GOOGLE_SHEET_PROPERTIES_GID:-373147482}
    volumes:
      - ./src:/app/src
      - ./tools:/app/tools
      - ./service_account.json:/app/service_account.json:ro
    depends_on:
      - fuseki
    networks:
      - arema-network

  fuseki:
    image: stain/jena-fuseki:5.1.0
    container_name: arema-fuseki
    ports:
      - "3030:3030"
    environment:
      - ADMIN_PASSWORD=${FUSEKI_PASSWORD}
    volumes:
      - ./tools/fuseki/data:/fuseki/databases
      - ./tools/fuseki/config.ttl:/fuseki/config.ttl
    command: ["/jena-fuseki/fuseki-server", "--config=/fuseki/config.ttl"]
    networks:
      - arema-network

networks:
  arema-network:
    driver: bridge
